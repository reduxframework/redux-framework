!function(l){"use strict";let u,p;redux.field_objects=redux.field_objects||{},redux.field_objects.repeater=redux.field_objects.repeater||{},redux.field_objects.repeater.getOptName=function(e){let r;return void 0===(r=void 0===(r=e.parents().find(".redux-ajax-security").data("opt-name"))?e.parents(".redux-container").data("opt-name"):r)?redux:redux.optName},redux.field_objects.repeater.init=function(e){e=e||l(document).find(".redux-group-tab:visible").find(".redux-container-repeater:visible"),l(e).each(function(){var e,r,t=l(this);let a=t;(a=t.hasClass("redux-field-container")?a:t.parents(".redux-field-container:first")).is(":hidden")||a.hasClass("redux-field-init")&&(a.removeClass("redux-field-init"),t.hasClass("redux-field-container")||(a=t.parents(".redux-field-container:first")),u=redux.field_objects.repeater.getOptName(t),e=a.attr("data-id"),r=t.find(".redux-repeater-accordion-repeater:last-child"),u.repeater[e].blank=r.clone().wrap("<p>").parent().html(),a.hasClass("redux-container-repeater")&&a.addClass("redux-field-init"),a.hasClass("redux-field-init"))&&(a.removeClass("redux-field-init"),redux.field_objects.repeater.setAccordion(t,e),redux.field_objects.repeater.bindTitle(t),redux.field_objects.repeater.remove(t,e),redux.field_objects.repeater.add(t))})},redux.field_objects.repeater.add=function(c){String.prototype.reduxReplaceAll=function(e,r){return this.replace(new RegExp(e.replace(/[.^$*+?()[{|]/g,"\\$&"),"g"),r)},c.find(".redux-repeaters-add").on("click",function(){var e,r,t,a;let i,d,n;const s=[];if(redux_change(l(this)),!l(this).hasClass("button-disabled"))if(r=(e=l(this).parent().find(".redux-repeater-accordion:first")).find(".redux-repeater-accordion-repeater").length,t=e.attr("data-id"),""!==u.repeater[t].limit&&r>=u.repeater[t].limit)l(this).addClass("button-disabled");else{if(r+=1,a=e.find(".redux-repeater-accordion-repeater").length,e.find(".redux-repeater-accordion-repeater:last").find(".ui-accordion-header").hasClass("ui-state-active")&&e.find(".redux-repeater-accordion-repeater:last").find(".ui-accordion-header").trigger("click"),0===(i=e.find(".redux-repeater-accordion-repeater:last").clone(!0,!0)).length&&(i=u.repeater[t].blank),u.repeater[t]&&(u.repeater[t].count=c.find(".redux-repeater-header").length,d=u.repeater[t].html.reduxReplaceAll("99999",a),l(i).find(".redux-repeater-header").text("")),i.find(".ui-accordion-content").html(d),i.find(".redux-container-editor")){const o=l(".redux-repeater-accordion-repeater").find(".redux-container-editor:first").attr("data-id");window.tinyMCEPreInit&&window.tinyMCEPreInit.mceInit&&window.tinyMCEPreInit.mceInit[o]&&(n=window.tinyMCEPreInit.mceInit[o]),l.each(i.find(".redux-container-editor"),function(){s.push(l(this).attr("data-id")),QTags.getInstance(o).settings.id=s[s.length-1]})}l(e).append(i),i.find(".redux-container-editor")&&l.each(s,function(e,r){tinymce.createEditor(r,n).render(),quicktags(r),QTags._buttonsInit()}),redux.field_objects.repeater.sort_repeaters(i),(i=l(this).parent().find(".redux-repeater-accordion:first")).find(".redux-repeater-accordion-repeater:last .ui-accordion-header").trigger("click"),i.find(".redux-repeater-accordion-repeater:last .bind_title").on("change keyup",function(e){let r;r=0<l(e.target).find(":selected").text().length?l(e.target).find(":selected").text():l(e.target).val(),l(this).closest(".redux-repeater-accordion-repeater").find(".redux-repeater-header").text(r)}),l.redux.checkRequired(c),0<u.repeater[t].limit&&r>=u.repeater[t].limit&&l(this).addClass("button-disabled"),!0===p&&2<=r&&c.find(".redux-repeater-accordion").accordion("option",{active:!1}),1<r&&redux.field_objects.repeater.remove(i)}})},redux.field_objects.repeater.remove=function(a){a.find(".redux-repeaters-remove").on("click",function(){let e,r,t;redux_change(l(this)),e=l(this).parents(".redux-container-repeater:first"),r=e.attr("data-id"),u.repeater[r].blank=l(this).parents(".redux-repeater-accordion-repeater:first").clone(!0,!0),l(this).parents(".redux-repeater-accordion-repeater:first").slideUp("medium",function(){l(this).remove(),redux.field_objects.repeater.sort_repeaters(a),""!==u.repeater[r].limit&&(t=e.find(".redux-repeater-accordion-repeater").length)<u.repeater[r].limit&&e.find(".redux-repeaters-add").removeClass("button-disabled"),e.find(".redux-repeater-accordion-repeater:last .ui-accordion-header").trigger("click")})}),a.find(".redux-repeater-accordion-repeater").hasClass("close-me")&&a.find(".redux-repeaters-remove").trigger("click")},redux.field_objects.repeater.bindTitle=function(e){e.find(".redux-repeater-accordion-repeater .bind_title").on("change keyup",function(e){let r;r=0<l(e.target).find(":selected").text().length?l(e.target).find(":selected").text():l(e.target).val(),l(this).closest(".redux-repeater-accordion-repeater").find(".redux-repeater-header").text(r)})},redux.field_objects.repeater.setAccordion=function(i,e){let r;var t=i.find(".redux-repeater-accordion");p=Boolean(t.data("panels-closed")),r=!0===p?Boolean(!1):0,t=i.find(".redux-repeater-accordion").accordion({header:"> div > fieldset > h3",collapsible:!0,active:r,beforeActivate:function(e){var r=l(this).next(".redux-repeaters-add").attr("data-name"),t=r.indexOf("["),r=r.substring(0,t);"function"==typeof reduxRepeaterAccordionBeforeActivate&&reduxRepeaterAccordionBeforeActivate(l(this),i,e,r)},activate:function(e,r){var t,a;l.redux.initFields(),"function"==typeof reduxRepeaterAccordionActivate&&(a=(t=l(this).next(".redux-repeaters-add").attr("data-name")).indexOf("["),t=t.substring(0,a),reduxRepeaterAccordionActivate(l(this),i,e,r,t))},heightStyle:"content",icons:{header:"ui-icon-plus",activeHeader:"ui-icon-minus"}}),!0===u.repeater[e].sortable?t.sortable({axis:"y",handle:"h3",placeholder:"ui-state-highlight",start:function(e,r){r.placeholder.height(r.item.height()),r.placeholder.width(r.item.width())},stop:function(e,r){r.item.children("h3").triggerHandler("focusout"),redux.field_objects.repeater.sort_repeaters(l(this))}}):t.find("h3.ui-accordion-header").css("cursor","pointer")},redux.field_objects.repeater.sort_repeaters=function(e){(e=e.hasClass("redux-container-repeater")?e:e.parents(".redux-container-repeater:first")).find(".redux-repeater-accordion-repeater").each(function(e){var r,t;const a=l(this).attr("data-sortid");let i=l(this).find(".redux-field .repeater[name*='["+a+"]']");i.each(function(){l(this).attr("name",l(this).attr("name").replace("["+a+"]","["+e+"]"))}),(i=l(this).find(".slide-title")).attr("name",i.attr("name").replace("["+a+"]","["+e+"]")),i.attr("data-key",e),l(this).attr("data-sortid",e),r=(t=l(this).find(".ui-accordion-header")).attr("id").split("-header-"),t.attr("id",r[0]+"-header-"+e),r=t.attr("aria-controls").split("-panel-"),t.attr("aria-controls",r[0]+"-panel-"+e),r=(t=l(this).find(".ui-accordion-content")).attr("id").split("-panel-"),t.attr("id",r[0]+"-panel-"+e),r=t.attr("aria-labelledby").split("-header-"),t.attr("aria-labelledby",r[0]+"-header-"+e)})},redux.field_objects.repeater.check_parents_dependencies=function(d){let n="";var e=d,r=e.lastIndexOf("-");const s=e.substring(r+1);r=e.replace(s,"99999");return u.required_child.hasOwnProperty(r)?l.each(u.required_child[r],function(e,r){var t;let a,i;return(t=l("#"+u.args.opt_name+"-"+r.parent+"-"+s)).hasClass("hide")?n=!1:!1!==n?(null!==(a=t.serializeForm())&&"object"==typeof a&&a.hasOwnProperty(u.args.opt_name)&&(i=(void 0===a[u.args.opt_name][r.parent]?Object.values(a[u.args.opt_name])[0]:a[u.args.opt_name])[r.parent],a=i[s]),t=a=l("#"+u.args.opt_name+"-"+d).hasClass("redux-container-media")?a.url:a,n=l.redux.check_dependencies_visibility(t,r),!1):void 0}):n=!0,n},redux_hook(l.redux,"required",function(){let a;a=redux.field_objects.repeater.getOptName(l(".redux-container-repeater")),l.each(a.folds,function(e,r){var t;-1!==e.indexOf("-99999")&&(e=e.replace("-99999","")),(t=l("[id^="+a.args.opt_name+"-"+e+"]")).find("*").hasClass("in-repeater")&&(t.addClass("fold"),"hide"===r)&&(t.addClass("hide"),t.prevUntil("fieldset").addClass("hide"),t.hasClass("redux-container-section")&&(r=l("#section-"+e)).hasClass("redux-section-indent-start")&&(l("#section-table-"+e).hide().addClass("hide"),r.hide().addClass("hide")),t.hasClass("redux-container-info")&&l("#info-"+e).hide().addClass("hide"),t.hasClass("redux-container-divide")&&l("#divide-"+e).hide().addClass("hide"),t.hasClass("redux-container-raw"))&&t.parents().find("table#"+redux.args.opt_name+"-"+e).hide().addClass("hide")})}),redux_hook(l.redux,"check_dependencies",function(e,r,t){var a,i;let d,n;l(t).hasClass("in-repeater")&&(a=(t=l(t)).parents(".redux-field:first").data("id"),t=t.parents(".redux-field-container:first"),d=t.hasClass("hide"),t=a.lastIndexOf("-"),i=a.substring(0,t),n=a.substring(t+1),l.each(u.required[i],function(e){var r,t;let a;-1!==e.indexOf("99999")&&(e=e.replace("99999",n)),r=l(this),a=!1,t=l("#"+u.args.opt_name+"-"+e),!0===(a=d?a:redux.field_objects.repeater.check_parents_dependencies(e))?t.fadeIn(300,function(){l(this).removeClass("hide"),l(this).prevUntil("fieldset").removeClass("hide"),u.required.hasOwnProperty(e)&&l.redux.check_dependencies(l("#"+u.args.opt_name+"-"+e).children().first()),l.redux.initFields()}):t.fadeOut(100,function(){l(this).addClass("hide"),l(this).prevUntil("fieldset").addClass("hide"),u.required.hasOwnProperty(e)&&l.redux.required_recursive_hide(e)}),r.find("select, radio, input[type=checkbox]").trigger("change")}))})}(jQuery);