!function(u){"use strict";var f,i,y,v;redux.field_objects=redux.field_objects||{},redux.field_objects.google_maps=redux.field_objects.google_maps||{},redux.field_objects.google_maps.init=function(e){e=e||u(document).find(".redux-group-tab:visible").find(".redux-container-google_maps:visible"),u(e).each(function(e){var o,t=u(this),n=t;(n=t.hasClass("redux-field-container")?n:t.parents(".redux-field-container:first")).is(":hidden")||n.hasClass("redux-field-init")&&(n.removeClass("redux-field-init"),n=t.find(".redux_framework_google_maps").attr("id"),o=Boolean(t.find(".redux_framework_google_maps").data("delay-render")),redux.field_objects.google_maps.clickHandler(t),redux.field_objects.google_maps.initMap(t,e,n,o),setTimeout(function(){u("#changetype-all").prop("checked",!0)},1))})},redux.field_objects.google_maps.clickHandler=function(o){o.find(".google_m_api_key_button").on("click",function(){var e=o.find(".google_m_api_key_wrapper");e.is(":visible")?e.slideUp("fast",function(){o.find("#google_m_api_key_input").trigger("focus")}):e.slideDown("medium",function(){o.find("#google_m_api_key_input").trigger("focus")})}),o.find(".google_m_autocomplete").on("click",function(e){this.trigger("focus"),this.trigger("select"),e.preventDefault()})},redux.field_objects.google_maps.renderMap=function(t,n){var a,s,l,e,o,d,r,i,g=!1,c=t.find(".redux_framework_google_maps").attr("id"),m=c+"_autocomplete",p=c+"_map_canvas",_=u("#"+p);y=new google.maps.places.Autocomplete(document.getElementById(m),{types:["geocode"]}),a=Boolean(n.data("scroll-wheel")),s=Boolean(n.data("street-view")),l=Boolean(n.data("map-type")),e=n.data("address"),e=(e=decodeURIComponent(e)).trim(),o=_.data("default-lat"),d=_.data("default-long"),r=_.data("default-zoom"),""!==e?""!==o&&""!==d||(g=!0):g=!1,o=o||39.11676722061108,d=d||-100.47761000000003,g?(new google.maps.Geocoder).geocode({address:e},function(e,o){o===google.maps.GeocoderStatus.OK?(v=e[0].geometry.location,i={center:v,zoom:r,streetViewControl:s,mapTypeControl:l,scrollwheel:a,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_BOTTOM}},f=new google.maps.Map(document.getElementById(p),i),redux.field_objects.google_maps.renderControls(t,m,n),t.find("#"+c+"_latitude").val(e[0].geometry.location.lat()),t.find("#"+c+"_longitude").val(e[0].geometry.location.lng())):alert("Geocode was not successful for the following reason: "+o)}):(v=new google.maps.LatLng(o,d),i={center:v,zoom:r,streetViewControl:s,mapTypeControl:l,scrollwheel:a,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_BOTTOM}},f=new google.maps.Map(document.getElementById(p),i),redux.field_objects.google_maps.renderControls(t,m,n))},redux.field_objects.google_maps.initMap=function(e,o,t,n){var a=e.find(".redux_framework_google_maps");u(a).attr("data-idx",o),!0===n||u("#"+t).hasClass("rendered")||(!0===Boolean(a.data("delay-render"))&&a.addClass("rendered"),redux.field_objects.google_maps.renderMap(e,a))},redux.field_objects.google_maps.renderControls=function(e,o,t){var n=e.find(".redux_framework_google_maps").attr("id")+"_type_selector",o=document.getElementById(o),n=document.getElementById(n);f.controls[google.maps.ControlPosition.TOP_LEFT].push(o),f.controls[google.maps.ControlPosition.TOP_LEFT].push(n),(y=new google.maps.places.Autocomplete(o)).bindTo("bounds",f),n=t.data("marker-tooltip"),n=decodeURIComponent(n),o=new google.maps.InfoWindow,i=new google.maps.Marker({position:v,map:f,anchorPoint:new google.maps.Point(0,-29),draggable:!0,title:n,animation:google.maps.Animation.DROP}),redux.field_objects.google_maps.addListeners(e,t,i,o)},redux.field_objects.google_maps.addListeners=function(t,e,n){var a,o=t.find(".redux_framework_google_maps").attr("id"),s=o+"_latitude",l=o+"_longitude",d=o+"_marker_info",r=e.data("geo-alert"),r=decodeURIComponent(r);google.maps.event.addListener(y,"place_changed",function(){var e,o;a.close(),n.setVisible(!1),(e=y.getPlace()).geometry?(e.geometry.viewport?f.fitBounds(e.geometry.viewport):(f.setCenter(e.geometry.location),f.setZoom(17)),n.setIcon({url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)}),n.setPosition(e.geometry.location),n.setVisible(!0),o="",e.address_components&&(o=[e.address_components[0]&&e.address_components[0].short_name||"",e.address_components[1]&&e.address_components[1].short_name||"",e.address_components[2]&&e.address_components[2].short_name||""].join(" ")),a.setContent("<div><strong>"+e.name+"</strong><br>"+o),a.open(f,n),redux.field_objects.google_maps.geoLocate(),redux.field_objects.google_maps.fillInAddress(t,s,l)):window.alert(r)}),redux.field_objects.google_maps.setupClickListener("changetype-all-"+o,[]),redux.field_objects.google_maps.setupClickListener("changetype-address-"+o,["address"]),redux.field_objects.google_maps.setupClickListener("changetype-establishment-"+o,["establishment"]),redux.field_objects.google_maps.setupClickListener("changetype-geocode-"+o,["geocode"]),google.maps.event.addListener(n,"drag",function(e){document.getElementById(s).value=e.latLng.lat(),document.getElementById(l).value=e.latLng.lng()}),google.maps.event.addListener(n,"dragend",function(){redux_change(t.find(".redux_framework_google_maps"))}),f.addListener("zoom_changed",function(){t.find(".google_m_zoom_input").val(f.getZoom())}),a=new google.maps.InfoWindow,google.maps.event.addListener(n,"click",function(){var e=document.getElementById(d).value;""!==e&&(a.setContent(e),a.open(f,i))})},redux.field_objects.google_maps.fillInAddress=function(e,o,t){var n,a,s,l,d,r=e.find(".redux_framework_google_maps").attr("id"),i={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},g=y.getPlace();for(n in document.getElementById(o).value=g.geometry.location.lat(),document.getElementById(t).value=g.geometry.location.lng(),i)i.hasOwnProperty(n)&&(n=r+"_"+n,document.getElementById(n).value="",document.getElementById(n).disabled=!1);for(d=g.address_components.length,a=0;a<d;a+=1)i[s=g.address_components[a].types[0]]&&(l=g.address_components[a][i[s]],document.getElementById(r+"_"+s).value=l)},redux.field_objects.google_maps.setupClickListener=function(e,o){e=document.getElementById(e);google.maps.event.addEventListener(e,"click",function(){y.setTypes(o)})},redux.field_objects.google_maps.geoLocate=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var o=new google.maps.LatLng(e.coords.latitude,e.coords.longitude),o=new google.maps.Circle({center:o,radius:e.coords.accuracy});y.setBounds(o.getBounds())})}}(jQuery);