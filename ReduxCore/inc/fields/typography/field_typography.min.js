!function(a){"use strict";a.reduxTypography=a.reduxTypography||{};var b=[],c=!1;a(document).ready(function(){a.reduxTypography.init()}),a.reduxTypography.init=function(){a(".redux-typography-container").each(function(){var b=a(this).find(".redux-typography-family");""!==b.data("value")&&a(b).val(b.data("value")),a.reduxTypography.select(b),window.onbeforeunload=null}),a(".redux-typography").on("change",function(){a.reduxTypography.select(a(this))}),a(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").keyup(function(){a.reduxTypography.select(a(this))}),a(".redux-typography-color").wpColorPicker({change:function(b,c){redux_change(a(this)),a(this).val(c.color.toString()),a.reduxTypography.select(a(this))}}),a(".redux-typography-size").numeric({allowMinus:!1}),a(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0});var d=[{id:"none",text:"none"}];a(".redux-typography-family").select2({matcher:function(a,b){return 0===b.toUpperCase().indexOf(a.toUpperCase())},query:function(a){return window.Select2.query.local(d)(a)},initSelection:function(a,b){var c={id:a.val(),text:a.val()};b(c)}}).on("select2-opening",function(){var b=a(this).parents(".redux-container-typography:first").attr("data-id"),c=a("#"+b+" .redux-typography-font-family").data("user-fonts");c=c?1:0;var e=a("#"+b+" .redux-typography-google").val();e=e?1:0;var f=[];if(void 0!==redux.customfonts&&f.push(redux.customfonts),void 0!==redux.stdfonts&&0===c&&f.push(redux.stdfonts),1==c){var g=[];for(var h in redux.typography[b]){var i=redux.typography[b].std_font;for(var j in i)i.hasOwnProperty(j)&&g.push({id:j,text:j,"data-google":"false"})}var k={text:"Standard Fonts",children:g};f.push(k)}(1==e||e===!0&&void 0!==redux.googlefonts)&&f.push(redux.googlefonts),d=f;var l=a("#"+b+" #"+b+"-family").attr("placeholder");l||(l=null),a("#"+b+" .redux-typography-family").select2("val",l)}).on("select2-selecting",function(d){var e=d.object.text,f=a(this).parents(".redux-container-typography:first").attr("data-id");a("#"+f+" #"+f+"-family").data("value",e),a("#"+f+" #"+f+"-family").attr("placeholder",e),b=d,c=!0}),a(" .redux-typography-family-backup, .redux-typography-align, .redux-typography-transform, .redux-typography-font-variant, .redux-typography-decoration").select2({width:"resolve",triggerChange:!0,allowClear:!0})},a.reduxTypography.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},a.reduxTypography.makeBool=function(a){return"false"==a||"0"==a||a===!1||0===a?!1:"true"==a||"1"==a||a===!0||1==a?!0:void 0},a.reduxTypography.select=function(d){var e=a(d).parents(".redux-container-typography:first").attr("data-id"),f=a("#"+e+" div.redux-typography-family").val();f||(f=null);var g,h=a("#"+e+" select.redux-typography-family-backup").val(),i=a("#"+e+" .redux-typography-size").val(),j=a("#"+e+" .redux-typography-height").val(),k=a("#"+e+" .redux-typography-word").val(),l=a("#"+e+" .redux-typography-letter").val(),m=a("#"+e+" select.redux-typography-align").val(),n=a("#"+e+" select.redux-typography-transform").val(),o=a("#"+e+" select.redux-typography-font-variant").val(),p=a("#"+e+" select.redux-typography-decoration").val(),q=a("#"+e+" select.redux-typography-style").val(),r=a("#"+e+" select.redux-typography-subsets").val(),s=a("#"+e+" .redux-typography-color").val(),t=a("#"+e).data("units"),u=f;c===!0?(g=a.reduxTypography.makeBool(b.object["data-google"]),a("#"+e+" .redux-typography-google-font").val(g)):g=a.reduxTypography.makeBool(a("#"+e+" .redux-typography-google-font").val()),a("#"+e).hasClass("typography-initialized")||(q=a("#"+e+" select.redux-typography-style").data("value"),r=a("#"+e+" select.redux-typography-subsets").data("value"),""!==q&&(q=String(q)),void 0!==typeof r&&(r=String(r))),void 0===redux.fonts.google&&(g=!1);var v="";if(v=g===!0&&f in redux.fonts.google?redux.fonts.google[f]:{400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},a(d).hasClass("redux-typography-family")){var w='<option value=""></option>';if(g===!0){var x="";a.each(v.variants,function(b,c){c.id===q||1===a.reduxTypography.size(v.variants)?(x=' selected="selected"',q=c.id):x="",w+='<option value="'+c.id+'"'+x+">"+c.name.replace(/\+/g," ")+"</option>"}),a("#"+e+" .redux-typography-style").select2("destroy"),a("#"+e+" .redux-typography-style").html(w),a("#"+e+" .redux-typography-style").select2({width:"resolve",triggerChange:!0,allowClear:!0}),x="",w='<option value=""></option>',a.each(v.subsets,function(b,c){c.id===r||1===a.reduxTypography.size(v.subsets)?(x=' selected="selected"',r=c.id):x="",w+='<option value="'+c.id+'"'+x+">"+c.name.replace(/\+/g," ")+"</option>"}),"undefined"!=typeof h&&""!==h&&(u+=", "+h),a("#"+e+" .redux-typography-subsets").select2("destroy"),a("#"+e+" .redux-typography-subsets").html(w),a("#"+e+" .redux-typography-subsets").select2({width:"resolve",triggerChange:!0,allowClear:!0}),a("#"+e+" .redux-typography-subsets").parent().fadeIn("fast"),a("#"+e+" .typography-family-backup").fadeIn("fast")}else v&&(a.each(v,function(b,c){b===q||"normal"===b?(x=' selected="selected"',a("#"+e+" .typography-style .select2-chosen").text(c)):x="",w+='<option value="'+b+'"'+x+">"+c.replace("+"," ")+"</option>"}),a("#"+e+" .redux-typography-style").select2("destroy"),a("#"+e+" .redux-typography-style").html(w),a("#"+e+" .redux-typography-style").select2({width:"resolve",triggerChange:!0,allowClear:!0}),a("#"+e+" .redux-typography-subsets").parent().fadeOut("fast"),a("#"+e+" .typography-family-backup").fadeOut("fast"))}else a(d).hasClass("redux-typography-family-backup")&&""!==h&&a("#"+e+" .redux-typography-font-family").val(u);0===a("#"+e+" select.redux-typography-style option[value='"+q+"']").length?(q="",a("#"+e+" select.redux-typography-style").select2("val","")):"400"===q&&a("#"+e+" select.redux-typography-style").select2("val",q),0===a("#"+e+" select.redux-typography-subsets option[value='"+r+"']").length&&(r="",a("#"+e+" select.redux-typography-subsets").select2("val",""));var y="style_link_"+e;if(a("."+y).remove(),null!==f&&"inherit"!==f&&a("#"+e).hasClass("typography-initialized")){var z=f.replace(/\s+/g,"+");if(g===!0){var A=z;q&&(A+=":"+q.replace(/\-/g," ")),r&&(A+="&subset="+r),"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[A]}}),a("#"+e+" .redux-typography-google").val(!0)}else a("#"+e+" .redux-typography-google").val(!1)}if(-1!==q.indexOf("italic")?(a("#"+e+" .typography-preview").css("font-style","italic"),a("#"+e+" .typography-font-style").val("italic"),q=q.replace("italic","")):a("#"+e+" .typography-preview").css("font-style","normal"),a("#"+e+" .typography-font-weight").val(q),j||(j=i),a("#"+e+" .typography-font-size").val(""===i?"":i+t),a("#"+e+" .typography-line-height").val(""===j?"":j+t),a("#"+e+" .typography-word-spacing").val(k+t),a("#"+e+" .typography-letter-spacing").val(l+t),a("#"+e).hasClass("typography-initialized")){var B=a("#"+e+" .typography-preview").data("preview-size");"0"==B&&a("#"+e+" .typography-preview").css("font-size",i+t),a("#"+e+" .typography-preview").css("font-weight",q),a("#"+e+" .typography-preview").css("font-family",f+", sans-serif"),"none"===f&&""===f&&a("#"+e+" .typography-preview").css("font-family","inherit"),a("#"+e+" .typography-preview").css("line-height",j+t),a("#"+e+" .typography-preview").css("word-spacing",k+t),a("#"+e+" .typography-preview").css("letter-spacing",l+t),s&&(a("#"+e+" .typography-preview").css("color",s),a("#"+e+" .typography-preview").css("background-color",getContrastColour(s))),a("#"+e+" .redux-typography-font-family").val(u),a("#"+e+" .typography-style .select2-chosen").text(a("#"+e+" .redux-typography-style option:selected").text()),a("#"+e+" .typography-script .select2-chosen").text(a("#"+e+" .redux-typography-subsets option:selected").text()),m&&a("#"+e+" .typography-preview").css("text-align",m),n&&a("#"+e+" .typography-preview").css("text-transform",n),o&&a("#"+e+" .typography-preview").css("font-variant",o),p&&a("#"+e+" .typography-preview").css("text-decoration",p),a("#"+e+" .typography-preview").slideDown()}a("#"+e).hasClass("typography-initialized")||a("#"+e).addClass("typography-initialized"),c=!1}}(jQuery);